import{a as d}from"./chunk-UXFWANHN.js";import{K as l,M as i,R as S,j as s,n as c,v as n}from"./chunk-QMNL5T2M.js";var f=(()=>{class o{constructor(e){this.http=e,this.CLASSES_STORAGE_KEY="mobaria_classes",this.CLASSES_TIMESTAMP_KEY="mobaria_classes_timestamp",this.CACHE_VALIDITY_DURATION=24*60*60*1e3}getQuests(){return s([])}getQuestById(e){return s(void 0)}getMonsters(){return s([])}getMonsterById(e){return s(void 0)}isCacheValid(){let e=localStorage.getItem(this.CLASSES_TIMESTAMP_KEY);if(!e)return!1;let t=parseInt(e,10);return Date.now()-t<this.CACHE_VALIDITY_DURATION}clearClassesCache(){localStorage.removeItem(this.CLASSES_STORAGE_KEY),localStorage.removeItem(this.CLASSES_TIMESTAMP_KEY),console.log("Cache des classes effac\xE9")}getClasses(){let e=localStorage.getItem(this.CLASSES_STORAGE_KEY);return e&&this.isCacheValid()?(console.log("Classes charg\xE9es depuis le localStorage"),s(JSON.parse(e))):this.http.get("assets/data/class-details.json").pipe(l(t=>{console.log("Classes charg\xE9es depuis le fichier JSON et stock\xE9es dans localStorage"),localStorage.setItem(this.CLASSES_STORAGE_KEY,JSON.stringify(t)),localStorage.setItem(this.CLASSES_TIMESTAMP_KEY,Date.now().toString())}),n(t=>(console.error("Erreur lors du chargement des classes:",t),e?(console.log("Utilisation des donn\xE9es en cache comme solution de secours"),s(JSON.parse(e))):s([]))))}getClassById(e){let t=localStorage.getItem(this.CLASSES_STORAGE_KEY);if(t&&this.isCacheValid()){console.log(`Recherche de la classe avec l'ID ${e} dans le localStorage`);let r=JSON.parse(t);return s(r.find(a=>a.id===e))}return this.getClasses().pipe(c(r=>(console.log(`Recherche de la classe avec l'ID ${e} apr\xE8s chargement du JSON`),r.find(a=>a.id===e))),n(r=>{if(console.error(`Erreur lors du chargement de la classe avec l'ID ${e}:`,r),t){console.log("Tentative d'utilisation des donn\xE9es en cache comme solution de secours");let a=JSON.parse(t);return s(a.find(h=>h.id===e))}return s(void 0)}))}getZones(){return s([])}getZoneById(e){return s(void 0)}static{this.\u0275fac=function(t){return new(t||o)(S(d))}}static{this.\u0275prov=i({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();export{f as a};
